<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Soft Local Scope · Numerical computing in Julia</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="Numerical computing in Julia logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="Numerical computing in Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit">Numerical computing in Julia</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../howto/">How to...</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Installation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../installation/julia/">Julia</a></li><li><a class="tocitem" href="../../installation/vscode/">Visual Studio Code</a></li><li><a class="tocitem" href="../../installation/git/">Git</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">1: Variables and basic operators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_01/variables/">Variables</a></li><li><a class="tocitem" href="../../lecture_01/operators/">Elementary Functions</a></li><li><a class="tocitem" href="../../lecture_01/strings/">Strings</a></li><li><a class="tocitem" href="../../lecture_01/arrays/">Arrays</a></li><li><a class="tocitem" href="../../lecture_01/data_structures/">Data Structures</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">2: Control flow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../conditions/">Conditional Evaluation</a></li><li><a class="tocitem" href="../loops/">Loops and Iterators</a></li><li class="is-active"><a class="tocitem" href>Soft Local Scope</a></li><li><a class="tocitem" href="../exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">3: Functions and methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_03/functions/">Functions</a></li><li><a class="tocitem" href="../../lecture_03/methods/">Methods</a></li><li><a class="tocitem" href="../../lecture_03/scope/">Scope of Variables</a></li><li><a class="tocitem" href="../../lecture_03/exceptions/">Exception Handling</a></li><li><a class="tocitem" href="../../lecture_03/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">4: Packages</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_04/basics/">Package Management</a></li><li><a class="tocitem" href="../../lecture_04/standardlibrary/">Standard Library</a></li><li><a class="tocitem" href="../../lecture_04/Plots/">Plots.jl</a></li><li><a class="tocitem" href="../../lecture_04/DataFrames/">DataFrames.jl</a></li><li><a class="tocitem" href="../../lecture_04/otherpackages/">Other Useful Packages</a></li><li><a class="tocitem" href="../../lecture_04/exercises/">Exercises</a></li></ul></li><li><span class="tocitem">5: Composite types and constructors</span></li><li><span class="tocitem">6: Modules and enviroments</span></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">7: Optimization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_07/theory/">Introduction to continuous optimization</a></li><li><a class="tocitem" href="../../lecture_07/unconstrained/">Unconstrained optimization</a></li><li><a class="tocitem" href="../../lecture_07/constrained/">Constrained optimization</a></li><li><a class="tocitem" href="../../lecture_07/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox"/><label class="tocitem" for="menuitem-11"><span class="docs-label">8: Regression and classification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_08/theory/">Theory of regression and classification</a></li><li><a class="tocitem" href="../../lecture_08/linear/">Linear regression</a></li><li><a class="tocitem" href="../../lecture_08/logistic/">Logistic regression</a></li><li><a class="tocitem" href="../../lecture_08/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-12" type="checkbox"/><label class="tocitem" for="menuitem-12"><span class="docs-label">9: Neural networks I.</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_09/theory/">Theory of neural networks</a></li><li><a class="tocitem" href="../../lecture_09/nn/">Neural networks</a></li><li><a class="tocitem" href="../../lecture_09/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-13" type="checkbox"/><label class="tocitem" for="menuitem-13"><span class="docs-label">10: Neural networks II.</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_10/theory/">Theory of neural networks</a></li><li><a class="tocitem" href="../../lecture_10/nn/">More complex networks</a></li><li><a class="tocitem" href="../../lecture_10/exercises/">Exercises</a></li></ul></li><li><span class="tocitem">11: Ordinary differential equations</span></li><li><span class="tocitem">12: Statistics I.</span></li><li><span class="tocitem">13: Statistics II.</span></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">2: Control flow</a></li><li class="is-active"><a href>Soft Local Scope</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Soft Local Scope</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/VaclavMacha/JuliaCourse/blob/master/docs/src/lecture_02/scope.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Soft-Local-Scope"><a class="docs-heading-anchor" href="#Soft-Local-Scope">Soft Local Scope</a><a id="Soft-Local-Scope-1"></a><a class="docs-heading-anchor-permalink" href="#Soft-Local-Scope" title="Permalink"></a></h1><p>The scope of a variable is the region of a code where a variable is visible. There are two main types of scopes in Julia: <strong>global</strong> and <strong>local</strong>, and we will discuss it <a href="../../lecture_03/scope/#Scope-of-Variables">later</a>. In this section, we will only focus on loops.</p><p>Every variable created inside a loop is local, i.e., it is possible to use it only inside the loop</p><pre><code class="language-julia-repl">julia&gt; for i in 1:2
           t = 1 + i
           @show t
       end
t = 2
t = 3

julia&gt; t
ERROR: UndefVarError: t not defined</code></pre><p>Note that the variable <code>i</code> in the example above is also local. It is possible to create nested local scopes, for example, nested loops. In such a case, the behavior is as follows</p><pre><code class="language-julia-repl">julia&gt; for j in 1:5
           for i in 1:2
               @show i + j
           end
           i
       end
i + j = 2
i + j = 3
ERROR: UndefVarError: i not defined</code></pre><p>The variable <code>j</code> is a local variable defined in the outer loop.  It means that <code>j</code> can be accessed in any local scope defined inside the outer loop, i.e., we can use it inside the inner loop.  On the other hand, the variable <code>i</code> is a local variable from the inner loop and, therefore, cannot be accessed in the outer loop.</p><p>What happens if we want to use variables from the global scope inside loops? In this case, it depends whether the loop is created in <em>interactive</em> context (REPL, Jupyter notebook) or <em>non-interactive</em> (file, eval). In the interactive case (in the REPL in our case), global variables can be accessed and modified in local scopes without any restrictions</p><pre><code class="language-julia-repl">julia&gt; s = 0
0

julia&gt; for i = 1:10
           t = 1 + i # new local variable t
           s = t # assigning a new value to the global variable
       end

julia&gt; s
11</code></pre><p>In this case, if we want to assign a value to a variable, there are two possibilities:</p><ul><li>The case of variable <code>t</code>: there is no global variable with the same name, then a new local variable is created.</li><li>The case of variable <code>s</code>: there is a global variable with the same name, then a new value is assigned to the global variable.</li></ul><p>However, in the non-interactive case, the variables behave differently. In the following example, we create a Julia code as a string and then evaluate it using the <code>include_string</code> function.</p><pre><code class="language-julia-repl">julia&gt; code = &quot;&quot;&quot;
       s = 0
       for i = 1:10
           t = 1 + i # new local variable t
           s = t #  new local variable s + warning
       end
       s
       &quot;&quot;&quot;;

julia&gt; include_string(Main, code)
┌ Warning: Assignment to `s` in soft scope is ambiguous because a global variable by the same name exists: `s` will be treated as a new local. Disambiguate by using `local s` to suppress this warning or `global s` to assign to the existing global variable.
└ @ string:4
0</code></pre><p>In this case, if we want to assign a value to a variable inside a loop, there are two possibilities:</p><ul><li>The case of variable <code>t</code>: there is no global variable with the same name, then a new local variable is created.</li><li>The case of variable <code>s</code>: there is a global variable with the same name, then assignment in soft scope is ambiguous, and a new local variable is created as in the first case.</li></ul><p>In our example, the variable <code>s</code> is defined before the loop as global. In the loop, we get a warning that the assignment to <code>s</code> in soft scope is ambiguous, and a new local variable <code>s</code> is created instead. The behavior described above can be changed by using the <code>local</code></p><pre><code class="language-julia">code_local = &quot;&quot;&quot;
s = 0
for i = 1:10
    t = 1 + i # new local variable t
    local s = t # assigning a new value to the global variable
end
s
&quot;&quot;&quot;</code></pre><p>or the <code>global</code> keyword</p><pre><code class="language-julia">code_global = &quot;&quot;&quot;
s = 0
for i = 1:10
    t = 1 + i # new local variable t
    global s = t # assigning a new value to the global variable
end
s
&quot;&quot;&quot;</code></pre><p>to specify whether the variable should be defined as local or global</p><pre><code class="language-julia-repl">julia&gt; include_string(Main, code_global)
11

julia&gt; include_string(Main, code_local)
0</code></pre><p>There are two obvious questions one could ask:</p><ol><li>Why doesn&#39;t it just work like the REPL everywhere?</li><li>Why doesn&#39;t it just work like in files everywhere? And maybe skip the warning?</li></ol><p>The behavior from REPL has the advantage of being intuitive and convenient since it approximates the behavior inside of a function body. In particular, it makes it easy to move code back and forth between a function body and the REPL when trying to debug the behavior of a function. However, it may easily lead to confusion and errors, especially if the code is long and/or split into multiple files. The intent of the following code is obvious: we want to modify the existing global variable <code>s</code> inside the loop</p><pre><code class="language-julia">s = 0
for i = 1:10
    s += i
end</code></pre><p>However, the actual code is usually more complicated. Consider the following example</p><pre><code class="language-julia">x = 200

# much later
# maybe in a different file

for i = 1:10
    x = 1000
    println(x)
end

# much later
# maybe in yet another file
# or maybe back in the first one where `x = 200`

y = x + 234</code></pre><p>It is not clear what should happen here. Should be the variable <code>x</code> inside the loop considered local or global? If we consider the variable <code>x</code> inside the loop as local, then the variable <code>y</code> will be <code>434</code>. On the other hand, if we consider the variable <code>x</code> inside the loop as global, then we assign a new value to it, and the variable <code>y</code> will be <code>1234</code>. We can accidentally change the value of a variable and get incorrect results because we use the same variable name multiple times in different scopes.  In this case, it is complicated to find why the results are wrong since there is no error in the code. To help users, Julia prints the warning about the ambiguity in such cases. For more information see official <a href="https://docs.julialang.org/en/v1/manual/variables-and-scoping/">documentation</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../loops/">« Loops and Iterators</a><a class="docs-footer-nextpage" href="../exercises/">Exercises »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 20 January 2021 13:14">Wednesday 20 January 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
