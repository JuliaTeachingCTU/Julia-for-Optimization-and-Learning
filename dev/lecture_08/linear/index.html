<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear regression · Numerical computing in Julia</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="Numerical computing in Julia logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="Numerical computing in Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit">Numerical computing in Julia</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../why_julia/">Why Julia?</a></li><li><a class="tocitem" href="../../howto/">How to...</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">1: Variables and basic operators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_01/variables/">Variables</a></li><li><a class="tocitem" href="../../lecture_01/operators/">Mathematical operations and Elementary functions</a></li><li><a class="tocitem" href="../../lecture_01/arrays/">Arrays</a></li><li><a class="tocitem" href="../../lecture_01/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../lecture_01/strings/">Strings</a></li><li><a class="tocitem" href="../../lecture_01/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">2: Control flow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_02/conditions/">Conditional evaluation</a></li><li><a class="tocitem" href="../../lecture_02/loops/">Loops and iterators</a></li><li><a class="tocitem" href="../../lecture_02/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">3: Functions and methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_03/functions/">Functions</a></li><li><a class="tocitem" href="../../lecture_03/methods/">Methods</a></li><li><a class="tocitem" href="../../lecture_03/scope/">Scope of Variables</a></li><li><a class="tocitem" href="../../lecture_03/exceptions/">Exception Handling</a></li><li><a class="tocitem" href="../../lecture_03/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">4: Packages</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_04/basics/">Package management</a></li><li><a class="tocitem" href="../../lecture_04/standardlibrary/">Standard library</a></li><li><a class="tocitem" href="../../lecture_04/DataFrames/">DataFrames.jl</a></li><li><a class="tocitem" href="../../lecture_04/Plots/">Plots.jl</a></li><li><a class="tocitem" href="../../lecture_04/otherpackages/">Other useful packages</a></li><li><a class="tocitem" href="../../lecture_04/exercises/">Exercises</a></li></ul></li><li><span class="tocitem">5: Composite types and constructors</span></li><li><span class="tocitem">6: Modules and enviroments</span></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">7: Optimization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_07/theory/">Theory of continuous optimization</a></li><li><a class="tocitem" href="../../lecture_07/gradients/">Visualization of gradients</a></li><li><a class="tocitem" href="../../lecture_07/numerical_methods/">Numerical methods</a></li><li><a class="tocitem" href="../../lecture_07/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox" checked/><label class="tocitem" for="menuitem-11"><span class="docs-label">8: Regression and classification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../theory/">Theory of regression and classification</a></li><li class="is-active"><a class="tocitem" href>Linear regression</a><ul class="internal"><li><a class="tocitem" href="#Loading-and-preparing-data"><span>Loading and preparing data</span></a></li><li><a class="tocitem" href="#Training-the-classifier"><span>Training the classifier</span></a></li></ul></li><li><a class="tocitem" href="../logistic/">Logistic regression</a></li><li><a class="tocitem" href="../exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-12" type="checkbox"/><label class="tocitem" for="menuitem-12"><span class="docs-label">9: Neural networks I.</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_09/theory/">Theory of neural networks</a></li><li><a class="tocitem" href="../../lecture_09/nn/">Neural networks</a></li><li><a class="tocitem" href="../../lecture_09/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-13" type="checkbox"/><label class="tocitem" for="menuitem-13"><span class="docs-label">10: Neural networks II.</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_10/theory/">Theory of neural networks</a></li><li><a class="tocitem" href="../../lecture_10/nn/">More complex networks</a></li><li><a class="tocitem" href="../../lecture_10/exercises/">Exercises</a></li></ul></li><li><span class="tocitem">11: Ordinary differential equations</span></li><li><span class="tocitem">12: Statistics I.</span></li><li><span class="tocitem">13: Statistics II.</span></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">8: Regression and classification</a></li><li class="is-active"><a href>Linear regression</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear regression</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/VaclavMacha/JuliaCourse/blob/master/docs/src/lecture_08/linear.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Linear-regression"><a class="docs-heading-anchor" href="#Linear-regression">Linear regression</a><a id="Linear-regression-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-regression" title="Permalink"></a></h1><p>Training a machine learning model requires data. Neural networks require lots of data. Since collecting data is difficult, there are many datasets at the <a href="http://archive.ics.uci.edu/ml/index.php">UCI Machine Learning Repository</a>. We will use the iris (kosatec in Czech) dataset which predicts one of the three types of iris based on sepal (kališní lístek in Czech) and petal (okvětní lístek in Czech) widths and lengths.</p><p><img src="../iris.png" alt/></p><p>If you do not see any differences between these three species, machine learning to the rescue!</p><h2 id="Loading-and-preparing-data"><a class="docs-heading-anchor" href="#Loading-and-preparing-data">Loading and preparing data</a><a id="Loading-and-preparing-data-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-and-preparing-data" title="Permalink"></a></h2><p>To experiment with machine learning models, we first need to load the data by</p><pre><code class="language-julia">using BSON

file_name = joinpath(&quot;data&quot;, &quot;iris.bson&quot;)
data = BSON.load(file_name)</code></pre><pre class="documenter-example-output">Dict{Symbol,Any} with 3 entries:
  :y      =&gt; [1, 1, 1, 1, 1, 1, 1, 1, 1, 1  …  3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
  :X      =&gt; [5.1 3.5 1.4 0.2; 4.9 3.0 1.4 0.2; … ; 6.2 3.4 5.4 2.3; 5.9 3.0 5.…
  :y_name =&gt; Any[&quot;Iris-setosa&quot;, &quot;Iris-versicolor&quot;, &quot;Iris-virginica&quot;]</pre><p>This creates a dictionary <code>data</code> whose entries can be accessed via <code>data[:X]</code>. The more straightforward way of loading is</p><pre><code class="language-julia">using BSON: @load

@load file_name X y y_name</code></pre><p>The data are prepared so that the columns of <code>X</code> (features) are sepal length, sepal width, petal length and petal width (in this order).</p><p>When designing a classification method, a good practice is to perform at least a basic analysis of the data. That may include checking for NaNs, infinite values, obvious errors, standard deviations of features or others. Here, we only plot the data. </p><div class = "exercise-body">
<header class = "exercise-header">Exercise:</header><p><p>We will simplify the goal and estimate the dependence of petal width on petal length. Create the data <span>$X$</span> (do not forget to add the bias) and the labels <span>$y$</span>.</p><p>Make a graph of the dependence of petal width on petal length.</p></p></div>
<details class = "solution-body">
<summary class = "solution-header">Solution:</summary><p><p>Since the petal length and width are the third and fourth columns, we assign them to <code>X</code> and <code>y</code>, respectively. Then we need to concatenate <code>X</code> it with a vector of ones to add the bias.</p><pre><code class="language-julia">y = X[:,4]
X = hcat(X[:,3], repeat([1], size(X,1)))</code></pre><p>The best plot, in this case, is the scatter plot.</p><pre><code class="language-julia">using Plots

scatter(X[:,1], y, label=&quot;&quot;, xlabel=&quot;Petal length&quot;, ylabel=&quot;Petal width&quot;)</code></pre></p></details><p><img src="../iris_lin1.svg" alt/></p><p>The figure shows a positive correlation between length and width. This is natural as bigger petals mean both longer and wider petals. We will quantify this dependence by the linear regression.</p><h2 id="Training-the-classifier"><a class="docs-heading-anchor" href="#Training-the-classifier">Training the classifier</a><a id="Training-the-classifier-1"></a><a class="docs-heading-anchor-permalink" href="#Training-the-classifier" title="Permalink"></a></h2><div class = "exercise-body">
<header class = "exercise-header">Exercise:</header><p><p>Use the closed-form formula to get the coefficients <span>$w$</span> for the linear regression. Then use the <code>optim</code> method derived in the previous lecture to solve the optimization problem via gradient descent. The results should be identical. Compare the elapsed time.</p></p></div>
<details class = "solution-body">
<summary class = "solution-header">Solution:</summary><p><p>The closed-form expression is <span>$(X^\top X)^{-1}X^\top y$</span>. This can be coded as <code>(X&#39;*X) \ (X&#39;*y)</code>. To measure the time, we use the <code>@time</code> macro.</p><pre><code class="language-julia">@time w = (X&#39;*X) \ (X&#39;*y)</code></pre><pre class="documenter-example-output">  1.109626 seconds (2.53 M allocations: 120.181 MiB, 5.53% gc time)</pre><p>For using the gradient descent, we first realize that the formula for the derivate is <span>$X^\top (Xw-y)$</span>. Defining the derivative function in <code>g</code>, we call the <code>optim</code> method in the same way as in the last lecture. Since we use the sum and not mean in the objective, we need to use much smaller stepsize this time.</p><pre><code class="language-julia">g(w) = X&#39;*(X*w-y)
@time w2 = optim([], g, zeros(size(X,2)), GD(1e-4); max_iter=10000)</code></pre><pre class="documenter-example-output">  0.047396 seconds (104.94 k allocations: 30.555 MiB)</pre><p>The difference between the solutions is</p><pre><code class="language-julia">using LinearAlgebra

norm(w-w2)</code></pre><pre class="documenter-example-output">2.9909026343018936e-12</pre><p>which is acceptable.</p></p></details><p>The correct solution is</p><pre class="documenter-example-output">2-element Array{Float64,1}:
  0.4164191322854024
 -0.3665140452167338</pre><p>This gives a piece of advice on how to predict the petal width if only petal length is known.</p><div class = "exercise-body">
<header class = "exercise-header">Exercise:</header><p><p>Write the dependence on the petal width on the petal length. Plot it in the previous graph.</p></p></div>
<details class = "solution-body">
<summary class = "solution-header">Solution:</summary><p><p>The desired dependence is</p><p class="math-container">\[\text{width} \approx -0.3665 + 0.4164*\text{length}.\]</p><p>Before plotting the prediction, we save it into <code>f_pred</code></p><pre><code class="language-julia">f_pred(x) = w[1]*x + w[2]</code></pre><p>Then we create the limits <code>x_lim</code> and finally plot a function which connects the two points. We move the legend to the top-left corner.</p><pre><code class="language-julia">x_lim = [minimum(X[:,1])-0.1; maximum(X[:,1])+0.1]

scatter(X[:,1], y, label=&quot;&quot;, xlabel=&quot;Petal length&quot;, ylabel=&quot;Petal width&quot;)
plot!(x_lim, f_pred.(x_lim), label=&quot;Prediction&quot;, legend=:topleft, line=(:black,3))</code></pre></p></details><p><img src="../iris_lin2.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Theory of regression and classification</a><a class="docs-footer-nextpage" href="../logistic/">Logistic regression »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 6 January 2021 08:45">Wednesday 6 January 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
