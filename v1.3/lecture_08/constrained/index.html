<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Constrained optimization · Julia for Optimization and Learning</title><meta name="title" content="Constrained optimization · Julia for Optimization and Learning"/><meta property="og:title" content="Constrained optimization · Julia for Optimization and Learning"/><meta property="twitter:title" content="Constrained optimization · Julia for Optimization and Learning"/><meta name="description" content="Documentation for Julia for Optimization and Learning."/><meta property="og:description" content="Documentation for Julia for Optimization and Learning."/><meta property="twitter:description" content="Documentation for Julia for Optimization and Learning."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="Julia for Optimization and Learning logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="Julia for Optimization and Learning logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Julia for Optimization and Learning</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../why/">Why Julia?</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Installation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../installation/installation/">Installation</a></li><li><a class="tocitem" href="../../installation/tutorial/">Quickstart guide</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">1: Basics I</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_01/variables/">Variables</a></li><li><a class="tocitem" href="../../lecture_01/operators/">Elementary functions</a></li><li><a class="tocitem" href="../../lecture_01/strings/">Strings</a></li><li><a class="tocitem" href="../../lecture_01/arrays/">Arrays</a></li><li><a class="tocitem" href="../../lecture_01/data_structures/">Data structures</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">2: Basics II</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_02/functions/">Funcion basics</a></li><li><a class="tocitem" href="../../lecture_02/conditions/">Conditional evaluations</a></li><li><a class="tocitem" href="../../lecture_02/loops/">Loops and iterators</a></li><li><a class="tocitem" href="../../lecture_02/scope/">Soft local scope</a></li><li><a class="tocitem" href="../../lecture_02/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">3: Packages</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_03/standardlibrary/">Standard library</a></li><li><a class="tocitem" href="../../lecture_03/pkg/">Package manager</a></li><li><a class="tocitem" href="../../lecture_03/Plots/">Plots.jl</a></li><li><a class="tocitem" href="../../lecture_03/DataFrames/">DataFrames.jl</a></li><li><a class="tocitem" href="../../lecture_03/otherpackages/">Other useful packages</a></li><li><a class="tocitem" href="../../lecture_03/interaction/">Interaction with other languages</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">4: Functions and methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_04/functions/">Functions</a></li><li><a class="tocitem" href="../../lecture_04/methods/">Methods</a></li><li><a class="tocitem" href="../../lecture_04/scope/">Scope of variables</a></li><li><a class="tocitem" href="../../lecture_04/exceptions/">Exception handling</a></li><li><a class="tocitem" href="../../lecture_04/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">5: Type system and generic programming</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_05/compositetypes/">Abstract and composite types</a></li><li><a class="tocitem" href="../../lecture_05/currencies/">Generic programming</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">6: Code organization I</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_06_07/modules/">Files and modules</a></li><li><a class="tocitem" href="../../lecture_06_07/develop/">Package development</a></li></ul></li><li><span class="tocitem">7: Code organization II</span></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox" checked/><label class="tocitem" for="menuitem-11"><span class="docs-label">8: Optimization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../theory/">Introduction to continuous optimization</a></li><li><a class="tocitem" href="../gradients/">Gradients</a></li><li><a class="tocitem" href="../unconstrained/">Unconstrained optimization</a></li><li class="is-active"><a class="tocitem" href>Constrained optimization</a><ul class="internal"><li><a class="tocitem" href="#Numerical-method"><span>Numerical method</span></a></li></ul></li><li><a class="tocitem" href="../exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-12" type="checkbox"/><label class="tocitem" for="menuitem-12"><span class="docs-label">9: Regression and classification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_09/theory/">Introduction to regression and classification</a></li><li><a class="tocitem" href="../../lecture_09/linear/">Linear regression</a></li><li><a class="tocitem" href="../../lecture_09/logistic/">Logistic regression</a></li><li><a class="tocitem" href="../../lecture_09/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-13" type="checkbox"/><label class="tocitem" for="menuitem-13"><span class="docs-label">10: Neural networks I.</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_10/theory/">Theory of neural networks</a></li><li><a class="tocitem" href="../../lecture_10/nn/">Neural networks</a></li><li><a class="tocitem" href="../../lecture_10/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14" type="checkbox"/><label class="tocitem" for="menuitem-14"><span class="docs-label">11: Neural networks II.</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_11/theory/">Theory of neural networks</a></li><li><a class="tocitem" href="../../lecture_11/iris/">Introduction to Flux</a></li><li><a class="tocitem" href="../../lecture_11/nn/">More complex networks</a></li><li><a class="tocitem" href="../../lecture_11/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-15" type="checkbox"/><label class="tocitem" for="menuitem-15"><span class="docs-label">12: Statistics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_12/sparse/">Linear regression with sparse constraints</a></li><li><a class="tocitem" href="../../lecture_12/monte/">Monte Carlo sampling</a></li><li><a class="tocitem" href="../../lecture_12/glm/">Linear regression revisited</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">8: Optimization</a></li><li class="is-active"><a href>Constrained optimization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Constrained optimization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaTeachingCTU/Julia-for-Optimization-and-Learning" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaTeachingCTU/Julia-for-Optimization-and-Learning/blob/master/docs/src/lecture_08/constrained.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="lagrangian"><a class="docs-heading-anchor" href="#lagrangian">Constrained optimization</a><a id="lagrangian-1"></a><a class="docs-heading-anchor-permalink" href="#lagrangian" title="Permalink"></a></h1><p>The usual formulation of constrained optimization is</p><p class="math-container">\[\tag{P}
\begin{aligned}
\text{minimize}\qquad &amp;f(x) \\
\text{subject to}\qquad &amp;g_i(x) \le 0,\ i=1,\dots,I, \\
&amp;h_j(x) = 0,\ j=1,\dots,J.
\end{aligned}\]</p><p>Functions <span>$g_i$</span> generate inequality constraints, while functions <span>$h_j$</span> generate equality constraints. Box constraints such as <span>$x\in[0,1]$</span> are the simplest case of the former. This optimization problem is also called the primal formulation. It is closely connected with the Lagrangian</p><p class="math-container">\[L(x;\lambda,\mu) = f(x)  + \sum_{i=1}^I \lambda_i g_i(x) + \sum_{j=1}^J \mu_j h_j(x).\]</p><p>Namely, it is simple to show that the primal formulation (P) is equivalent to</p><p class="math-container">\[\operatorname*{minimize}_x\quad \operatorname*{maximize}_{\lambda\ge 0,\mu}\quad L(x;\lambda,\mu).\]</p><p>The dual problem then switches the minimization and maximization to arrive at</p><p class="math-container">\[\tag{D} \operatorname*{maximize}_{\lambda\ge 0,\mu} \quad\operatorname*{minimize}_x\quad L(x;\lambda,\mu).\]</p><p>Even though the primal and dual formulations are not generally equivalent, they are often used interchangeably.</p><div class="admonition is-info"><header class="admonition-header">Linear programming:</header><div class="admonition-body"><p>The linear program</p><p class="math-container">\[\begin{aligned}
\text{minimize}\qquad &amp;c^\top x \\
\text{subject to}\qquad &amp;Ax=b, \\
&amp;x\ge 0
\end{aligned}\]</p><p>is equivalent to</p><p class="math-container">\[\begin{aligned}
\text{maximize}\qquad &amp;b^\top \mu \\
\text{subject to}\qquad &amp;A^\top \mu\le c.
\end{aligned}\]</p><p>We can observe several things:</p><ol><li>Primal and dual problems switch minimization and maximization.</li><li>Primal and dual problems switch variables and constraints.</li></ol></div></div><p>For the unconstrained optimization, we showed that each local minimum satisfies the optimality condition <span>$\nabla f(x)=0$</span>. This condition does not have to hold for constrained optimization, where the optimality conditions are of a more complex form.</p><div class="admonition is-todo"><header class="admonition-header">Theorem: Karush-Kuhn-Tucker conditions</header><div class="admonition-body"><p>Let <span>$f$</span>, <span>$g_i$</span> and <span>$h_j$</span> be differentiable function and let a constraint qualification hold. If <span>$x$</span> is a local minimum of the primal problem (P), then there are <span>$\lambda\ge 0$</span> and <span>$\mu$</span> such that</p><p class="math-container">\[    \begin{aligned}
    &amp;\text{Optimality:} &amp;&amp; \nabla_x L(x;\lambda,\mu) = 0, \\
    &amp;\text{Feasibility:} &amp;&amp; \nabla_\lambda L(x;\lambda,\mu)\le 0,\ \nabla_\mu L(x;\lambda,\mu) = 0, \\
    &amp;\text{Complementarity:} &amp;&amp; \lambda^\top g(x) = 0.
    \end{aligned}\]</p><p>If <span>$f$</span> and <span>$g$</span> are convex and <span>$h$</span> is linear, then every stationary point is a global minimum of (P).</p></div></div><p>When there are no constraints, the Lagrangian <span>$L$</span> reduces to the objective <span>$f$</span>, and the optimality conditions are equivalent. Therefore, the optimality conditions for constrained optimization generalize those for unconstrained optimization.</p><h2 id="Numerical-method"><a class="docs-heading-anchor" href="#Numerical-method">Numerical method</a><a id="Numerical-method-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-method" title="Permalink"></a></h2><p>We present only the simplest method for constraint optimization. Projected gradients</p><p class="math-container">\[\begin{aligned}
y^{k+1} &amp;= x^k - \alpha^k\nabla f(x^k), \\
x^{k+1} &amp;= P_X(y^{k+1})
\end{aligned}\]</p><p>compute the gradient as for standard gradient descent, and then project the point onto the feasible set. Since the projection needs to be simple to calculate, projected gradients are used for simple <span>$X$</span> such as boxes or balls. </p><p>We will use projected gradients to solve</p><p class="math-container">\[\begin{aligned}
\text{minimize}\qquad &amp;\sin(x_1 + x_2) + \cos(x_1)^2 \\
\text{subject to}\qquad &amp;x_1, x_2\in [-1,1].
\end{aligned}\]</p><p>The implementation of projected gradients is the same as gradient descent but it needs projection function <code>P</code> as input. For reasons of plotting, it returns both <span>$x$</span> and <span>$y$</span>.</p><pre><code class="language-julia hljs">function optim(f, g, P, x, α; max_iter=100)
    xs = zeros(length(x), max_iter+1)
    ys = zeros(length(x), max_iter)
    xs[:,1] = x
    for i in 1:max_iter
        ys[:,i] = xs[:,i] - α*g(xs[:,i])
        xs[:,i+1] = P(ys[:,i])
    end
    return xs, ys
end</code></pre><p>The projection function <code>P</code> computes the projection on <code>[x_min, x_max]</code>. Since it is a box, the projection is computed componentwise:</p><pre><code class="language-julia hljs">P(x, x_min, x_max) = min.(max.(x, x_min), x_max)</code></pre><p>Now we can call projected gradients from the same starting point as before.</p><pre><code class="language-julia hljs">x_min = [-1; -1]
x_max = [0; 0]

xs, ys = optim(f, g, x -&gt; P(x,x_min,x_max), [0;-1], 0.1)</code></pre><p>We use the keyword arguments <code>xbounds</code> and <code>ybounds</code> to plot the feasible region in the animation. First, we plot only the iterations <code>xs</code>.</p><pre><code class="language-julia hljs">xlims = (-3, 1)
ylims = (-2, 1)

create_anim(f, xs, xlims, ylims, &quot;anim6.gif&quot;;
    xbounds=(x_min[1], x_max[1]),
    ybounds=(x_min[2], x_max[2]),
)</code></pre><p><img src="../anim6.gif" alt/></p><p>To plot the path, we need to merge them by following one point from <code>xs</code> by a point from <code>ys</code> and so on. Since <code>xs</code> and <code>ys</code> have different number of entries, we can do it via</p><pre><code class="language-julia hljs">xys = hcat(reshape([xs[:,1:end-1]; ys][:], 2, :), xs[:,end])</code></pre><p>It is probably not the nicest thing to do, but it is Saturday evening, I am tired, and it works. Sorry :) The animation can now be created in the same way as before. </p><pre><code class="language-julia hljs">create_anim(f, xys, xlims, ylims, &quot;anim7.gif&quot;;
    xbounds=(x_min[1], x_max[1]),
    ybounds=(x_min[2], x_max[2]),
)</code></pre><p><img src="../anim7.gif" alt/></p><p>The animation shows that projected gradients converge to the global minimum. Most of the iterations are outside of the feasible region, but they are projected back to the boundary. One can use the optimality conditions to verify that the gradient of the objective and the active constraint have the same direction.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../unconstrained/">« Unconstrained optimization</a><a class="docs-footer-nextpage" href="../exercises/">Exercises »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 26 September 2024 06:15">Thursday 26 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
