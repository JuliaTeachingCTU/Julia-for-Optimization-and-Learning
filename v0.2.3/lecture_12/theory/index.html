<!DOCTYPE html><HTML lang="en"><head><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Differential equations · Julia for Machine Learning</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script data-main="../../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="../../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><script data-outdated-warner="">function maybeAddWarning () {
    const head = document.getElementsByTagName('head')[0];

    // Add a noindex meta tag (unless one exists) so that search engines don't index this version of the docs.
    if (document.body.querySelector('meta[name="robots"]') === null) {
        const meta = document.createElement('meta');
        meta.name = 'robots';
        meta.content = 'noindex';

        head.appendChild(meta);
    };

    // Add a stylesheet to avoid inline styling
    const style = document.createElement('style');
    style.type = 'text/css';
    style.appendChild(document.createTextNode('.outdated-warning-overlay {  position: fixed;  top: 0;  left: 0;  right: 0;  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);  z-index: 999;  background-color: #ffaba7;  color: rgba(0, 0, 0, 0.7);  border-bottom: 3px solid #da0b00;  padding: 10px 35px;  text-align: center;  font-size: 15px; }  .outdated-warning-overlay .outdated-warning-closer {    position: absolute;    top: calc(50% - 10px);    right: 18px;    cursor: pointer;    width: 12px; }  .outdated-warning-overlay a {    color: #2e63b8; }    .outdated-warning-overlay a:hover {      color: #363636; }'));
    head.appendChild(style);

    const div = document.createElement('div');
    div.classList.add('outdated-warning-overlay');
    const closer = document.createElement('div');
    closer.classList.add('outdated-warning-closer');

    // Icon by font-awesome (license: https://fontawesome.com/license, link: https://fontawesome.com/icons/times?style=solid)
    closer.innerHTML = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>';
    closer.addEventListener('click', function () {
        document.body.removeChild(div);
    });
    let href = '/stable';
    if (window.documenterBaseURL) {
        href = window.documenterBaseURL + '/../stable';
    }
    div.innerHTML = 'This documentation is not for the latest version. <br> <a href="' + href + '">Go to the latest documentation</a>.';
    div.appendChild(closer);
    document.body.appendChild(div);
};

if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', maybeAddWarning);
} else {
    maybeAddWarning();
};
</script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img alt="Julia for Machine Learning logo" class="docs-light-only" src="../../assets/logo.svg"/><img alt="Julia for Machine Learning logo" class="docs-dark-only" src="../../assets/logo-dark.svg"/></a><div class="docs-package-name"><span class="docs-autofit">Julia for Machine Learning</span></div><form action="../../search/" class="docs-search"><input class="docs-search-query" id="documenter-search-query" name="q" placeholder="Search docs" type="text"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../why/">Why Julia?</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Installation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../installation/julia/">Julia</a></li><li><a class="tocitem" href="../../installation/vscode/">Visual Studio Code</a></li><li><a class="tocitem" href="../../installation/git/">Git</a></li><li><a class="tocitem" href="../../installation/tutorial/">Quickstart guide</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">1: Variables and basic operators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_01/variables/">Variables</a></li><li><a class="tocitem" href="../../lecture_01/operators/">Elementary functions</a></li><li><a class="tocitem" href="../../lecture_01/strings/">Strings</a></li><li><a class="tocitem" href="../../lecture_01/arrays/">Arrays</a></li><li><a class="tocitem" href="../../lecture_01/data_structures/">Data structures</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">2: Control flow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_02/conditions/">Conditional evaluations</a></li><li><a class="tocitem" href="../../lecture_02/loops/">Loops and iterators</a></li><li><a class="tocitem" href="../../lecture_02/scope/">Soft local scope</a></li><li><a class="tocitem" href="../../lecture_02/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">3: Functions and methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_03/functions/">Functions</a></li><li><a class="tocitem" href="../../lecture_03/methods/">Methods</a></li><li><a class="tocitem" href="../../lecture_03/scope/">Scope of variables</a></li><li><a class="tocitem" href="../../lecture_03/exceptions/">Exception handling</a></li><li><a class="tocitem" href="../../lecture_03/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">4: Packages</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_04/standardlibrary/">Standard library</a></li><li><a class="tocitem" href="../../lecture_04/Plots/">Plots.jl</a></li><li><a class="tocitem" href="../../lecture_04/DataFrames/">DataFrames.jl</a></li><li><a class="tocitem" href="../../lecture_04/otherpackages/">Other useful packages</a></li><li><a class="tocitem" href="../../lecture_04/interaction/">Interaction with other languages</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">5: Type system and generic programming</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_05/compositetypes/">Abstract and composit types</a></li><li><a class="tocitem" href="../../lecture_05/currencies/">Generic programming</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">6: Code organization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_06/modules/">Files and modules</a></li><li><a class="tocitem" href="../../lecture_06/pkg/">Package manager</a></li><li><a class="tocitem" href="../../lecture_06/develop/">Package development</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Course requirements</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../final_project/homeworks/">Homework</a></li><li><a class="tocitem" href="../../final_project/project/">Final project</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox"/><label class="tocitem" for="menuitem-11"><span class="docs-label">7: Optimization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_07/theory/">Introduction to continuous optimization</a></li><li><a class="tocitem" href="../../lecture_07/unconstrained/">Unconstrained optimization</a></li><li><a class="tocitem" href="../../lecture_07/constrained/">Constrained optimization</a></li><li><a class="tocitem" href="../../lecture_07/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-12" type="checkbox"/><label class="tocitem" for="menuitem-12"><span class="docs-label">8: Regression and classification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_08/theory/">Theory of regression and classification</a></li><li><a class="tocitem" href="../../lecture_08/linear/">Linear regression</a></li><li><a class="tocitem" href="../../lecture_08/logistic/">Logistic regression</a></li><li><a class="tocitem" href="../../lecture_08/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-13" type="checkbox"/><label class="tocitem" for="menuitem-13"><span class="docs-label">9: Neural networks I.</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_09/theory/">Theory of neural networks</a></li><li><a class="tocitem" href="../../lecture_09/nn/">Neural networks</a></li><li><a class="tocitem" href="../../lecture_09/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14" type="checkbox"/><label class="tocitem" for="menuitem-14"><span class="docs-label">10: Neural networks II.</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_10/theory/">Theory of neural networks</a></li><li><a class="tocitem" href="../../lecture_10/nn/">More complex networks</a></li><li><a class="tocitem" href="../../lecture_10/exercises/">Exercises</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-15" type="checkbox"/><label class="tocitem" for="menuitem-15"><span class="docs-label">11: Statistics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lecture_11/theory/">Statistics</a></li></ul></li><li><input checked="" class="collapse-toggle" id="menuitem-16" type="checkbox"/><label class="tocitem" for="menuitem-16"><span class="docs-label">12: Ordinary differential equations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href="">Differential equations</a><ul class="internal"><li><a class="tocitem" href="#Ordinary-differential-equations"><span>Ordinary differential equations</span></a></li><li><a class="tocitem" href="#Linear-ODE"><span>Linear ODE</span></a></li><li><a class="tocitem" href="#Matrix-decompositions"><span>Matrix decompositions</span></a></li></ul></li><li><a class="tocitem" href="../ode/">Wave equation</a></li><li><a class="tocitem" href="../diff_eq/">Julia package</a></li><li><a class="tocitem" href="../optimal_control/">Optimal control</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">12: Ordinary differential equations</a></li><li class="is-active"><a href="">Differential equations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">Differential equations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/VaclavMacha/JuliaCourse/blob/master/docs/src/lecture_12/theory.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a></div></header><article class="content" id="documenter-page"><h1 id="Differential-equations"><a class="docs-heading-anchor" href="#Differential-equations">Differential equations</a><a id="Differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Differential-equations" title="Permalink"></a></h1><p>Differential equations describe many natural phenomena. The Newton's law of motion</p><p class="math-container">\[F = \frac{\partial}{\partial t}mv\]</p><p>is a simple but extremely important example of an ordinary differential equation. Besides applications in physics and engineering, differential equations appear in almost any (smoothly) evolving system. Examples include economics (Black-Scholes formula) or biology (population growth). There are whole fields dedicated to solving a single equation such as the wave or heat equations. The basic distinction is:</p><ul><li><em>Ordinary differential equations</em> (ODEs) depend only on time.</li><li><em>Partial differential equations</em> (PDEs) depend both on time and space. The spacial variable is usually 1D, 2D or 3D.</li></ul><p>There are many extensions; let us name systems of differential equations, stochastic differential equations, differential algebraic equations (system of differential and non-differential equations) and others.</p><h2 id="Ordinary-differential-equations"><a class="docs-heading-anchor" href="#Ordinary-differential-equations">Ordinary differential equations</a><a id="Ordinary-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Ordinary-differential-equations" title="Permalink"></a></h2><p>Oridnary differential equations take form</p><p class="math-container">\[\dot y(t) = f(t, y(t))\]</p><p>on some interval <span>$t\in [0,T]$</span>. To obtain a correct definition, the initial value <span>$y(0)=y_0$</span> needs to be provided. A solution is a (sufficiently smooth) function <span>$y(t)$</span> such that the above formula is satisfied (almost) everywhere on <span>$[0,T]$</span>. The existence and uniqueness is ensured by mild conditions.</p><div class="theorem-body"><header class="theorem-header">Picard–Lindelöf theorem</header><p></p><p>Suppose <span>$f$</span> is uniformly Lipschitz continuous in <span>$y$</span> (the Lipschitz constant is independent of <span>$t$</span>) and continuous in <span>$t$</span>. Then for some value <span>$\varepsilon &gt; 0$</span>, there exists a unique solution <span>$y(t)$</span> to the initial value problem on the interval <span>$[t_0-\varepsilon, t_0+\varepsilon]$</span>.</p><p></p></div><p>However, it may happen than even simple equations do not have a unique solution.</p><div class="info-body"><header class="info-header">Uniqueness</header><p></p><p>The uniqueness of solution is not guaranteed even for simple equations. Equation</p><p class="math-container">\[\begin{aligned}
\dot y(t) &amp;= y^{\frac 23}(t), \\
y(0) &amp;= 0
\end{aligned}\]</p><p>has at least two solution: <span>$y_1(t)=0$</span> and <span>$y_2(t)=(\frac t3)^3$</span>. This is possible because the right-hand side of the ODE has an infinite derivative at zero and the Lipschitz continuity assumption of the Picard–Lindelöf theorem is not satisfied.</p><p></p></div><p>The theory of partial differential equations is complicated because they employ a special definition of derivative (weak derivative) and the solution is defined on special spaces (Sobolev spaces). It may happen that a function has (weak) derivative but it is not continuous.</p><h2 id="Linear-ODE"><a class="docs-heading-anchor" href="#Linear-ODE">Linear ODE</a><a id="Linear-ODE-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-ODE" title="Permalink"></a></h2><p>Linear ordinary equations</p><p class="math-container">\[\dot y(t) = Ay(t) + b(t)\]</p><p>form an important subclass of differential equations. They admit a "closed-form" solution. This closed form employs the matrix exponential defined by</p><p class="math-container">\[e^{A} = \sum_{k=0}^{\infty} \frac{A^k}{k!},\]</p><p>where <span>$A^k$</span> is the standard multiplication of matrices. This is a generalization from scalars to matrices and has similar properties. For example, the derivative of the matrix exponential is the same object due to</p><p class="math-container">\[\frac{\partial}{\partial A}e^{A} = \sum_{k=0}^{\infty} A\frac{A^{k-1}}{k!} = \sum_{k=0}^{\infty} \frac{A^k}{k!} = e^{A}.\]</p><p>Then the solution of the linear equation above equals to</p><p class="math-container">\[y(t) = e^{At}\left(y_0 + \int_0^t e^{-As}b(s)ds\right).\]</p><p>Indeed, the derivative of the previous term equals to</p><p class="math-container">\[\dot y(t) = Ae^{At}\left(y_0 + \int_0^t e^{-As}b(s)ds\right) + e^{At}e^{-At}b(t) = Ay(t) + b(t)\]</p><p>because <span>$e^{At}e^{-At}$</span> is the identity matrix (similarly to <span>$e^xe^{-x}=1$</span>). The matrix exponential can be computed using matrix decompositions.</p><h2 id="Matrix-decompositions"><a class="docs-heading-anchor" href="#Matrix-decompositions">Matrix decompositions</a><a id="Matrix-decompositions-1"></a><a class="docs-heading-anchor-permalink" href="#Matrix-decompositions" title="Permalink"></a></h2><p>There are many matrix decompositions. They are closely related to finding eigenvalues and eigenvectors. We mention only two basic decompositions.</p><h4 id="Cholesky-decomposition"><a class="docs-heading-anchor" href="#Cholesky-decomposition">Cholesky decomposition</a><a id="Cholesky-decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Cholesky-decomposition" title="Permalink"></a></h4><p>For a real positive semidefinite matrix <span>$A$</span>, its Cholesky decomposition always exists and reads</p><p class="math-container">\[A = LL^\top,\]</p><p>where <span>$L$</span> is a real lower triangular matrix (zeros above the diagonal). This matrix is easily invertible and the decomposition is used in iterative algorithms where the matrix inversion needs to be computed many times.</p><h4 id="Eigenvalue-decomposition"><a class="docs-heading-anchor" href="#Eigenvalue-decomposition">Eigenvalue decomposition</a><a id="Eigenvalue-decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenvalue-decomposition" title="Permalink"></a></h4><p>For a square matrix <span>$A$</span> of size <span>$n\times n$</span>, we assume that there are <span>$n$</span> linearly independent eigenvectors (matrices which do not satisfy this are called defective). Then the eigendecomposition equals to</p><p class="math-container">\[A = Q\Lambda Q^{-1},\]</p><p>where <span>$\Lambda$</span> is a diagonal matrix with eigenvalues on the diagonal and the columns of <span>$Q$</span> are orthonormal eigenvectors. This allows us to compute the matrix exponential</p><p class="math-container">\[e^A = e^{Q\Lambda Q^{-1}} = Qe^\Lambda Q^{-1}\]</p><p>as <span>$e^\Lambda$</span> is a diagonal matrix with entries</p><p class="math-container">\[(e^\Lambda)_{ij} = \begin{cases} e^{\Lambda_{ii}}&amp;\text{if }i=j \\ 0&amp;\text{otherwise}\end{cases}.\]</p><p>This allows to compute the closed-form solution of the linear ODEs.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../lecture_11/theory/">« Statistics</a><a class="docs-footer-nextpage" href="../ode/">Wave equation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 8 March 2021 20:48">Monday 8 March 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>